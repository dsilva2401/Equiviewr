var EquiViewr=function(A){const e=Math.PI/180;var t,n,C,Q,o,a,i,r,s,d,m,l,f,c,y,h,u,p=70,w=!1,x=0,v=0,g=0,E=0,T=this,b={};r=A.limits&&A.limits.minY||-90,s=A.limits&&A.limits.maxY||90,o=A.imgSrc||"",d=A.container,Q={width:d.clientWidth,height:d.clientHeight};var z=function(){m=document.createElement("div"),m.style.position="absolute",m.style.left="0px",m.style.top="0px",m.style.width="100%",m.style.height="100%",c=Math.round(.8*Q.width),f=document.createElement("div"),f.style.position="absolute",f.style.left=Math.round(Q.width/2-c/2)+"px",f.style.bottom=Math.round(c/-2)+"px",f.style.width=c+"px",f.style.height=c+"px",f.style["-moz-transform"]="perspective( 900px ) rotateX( 70deg )",f.style["-webkit-transform"]="perspective( 900px ) rotateX( 70deg )",f.style.transform="perspective( 900px ) rotateX( 70deg )",y=document.createElement("div"),y.style.position="absolute",y.style.left="0px",y.style.top="0px",y.style.width="100%",y.style.height="100%",y.style["-webkit-border-radius"]="100%",y.style["-moz-border-radius"]="100%",y.style["border-radius"]="100%",T.on("move",R),d.addEventListener("mousedown",F,!1),d.addEventListener("mousemove",J,!1),d.addEventListener("mouseup",U,!1),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(A){window.setTimeout(A,1e3/60)}}(),f.appendChild(y),d.appendChild(m),d.appendChild(f)},M=function(A){t=new THREE.PerspectiveCamera(p,Q.width/Q.height,1,1100),t.target=new THREE.Vector3(0,0,0),n=new THREE.Scene,l=new THREE.Mesh(new THREE.SphereGeometry(500,60,40),new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(A)})),l.scale.x=-1,n.add(l),C=new THREE.WebGLRenderer,C.setSize(Q.width,Q.height),m.innerHTML="",m.appendChild(C.domElement)},R=function(A){f.style["-moz-transform"]="perspective( 900px ) rotateX( "+(70+.4*A.y)+"deg )",f.style["-webkit-transform"]="perspective( 900px ) rotateX( "+(70+.4*A.y)+"deg )",f.style.transform="perspective( 900px ) rotateX( "+(70+.4*A.y)+"deg )",y.style["-moz-transform"]="rotateZ( "+-A.x+"deg )",y.style["-webkit-transform"]="rotateZ( "+-A.x+"deg )",y.style.transform="rotateZ( "+-A.x+"deg )"},F=function(A){A.preventDefault(),w=!0,a=A.clientX,i=A.clientY,h=x,u=v},J=function(A){w&&(x=.1*(a-A.clientX)+h,x=(x+360)%360,v=.1*(A.clientY-i)+u,v=Math.min(s,Math.max(v,r)),P("move",function(A){A({x:x,y:v})}))},U=function(){w=!1},X=function(){requestAnimationFrame(X),S()},P=function(A,e){b[A]&&b[A].length&&b[A].forEach(function(A){e(A)})},S=function(){v=Math.max(-85,Math.min(85,v)),g=THREE.Math.degToRad(90-v),E=THREE.Math.degToRad(x),t.target.x=500*Math.sin(g)*Math.cos(E),t.target.y=500*Math.cos(g),t.target.z=500*Math.sin(g)*Math.sin(E),t.lookAt(t.target),C.render(n,t)};T.on=function(A,e){b[A]||(b[A]=[]),b[A].push(e)},T.moveSoftTo=function(A,e){A.x="undefined"!=typeof A.x?A.x:x,A.y="undefined"!=typeof A.y?A.y:v;var t=35,n=A.x-x,C=A.y-v;if(!n&&!C)return void e();var Q=n/t,o=C/t,a=setInterval(function(){x+=Q,v+=o,P("move",function(A){A({x:x,y:v})}),t--,t||(clearInterval(a),e&&e())},20)},T.moveTo=function(A){A&&(A.x&&(x=A.x),A.y&&(v=A.y),S(),P("move",function(A){A({x:x,y:v})}))},T.zoomIn=function(A){var e=25,n=1.4,C=40,o=setInterval(function(){p-=n,t.projectionMatrix.makePerspective(p,Q.width/Q.height,1,1100),S(),e--,e||(clearInterval(o),A&&A())},1e3/C)},T.zoomOut=function(A){var e=25,n=1.4,C=40,o=setInterval(function(){p+=n,t.projectionMatrix.makePerspective(p,Q.width/Q.height,1,1100),S(),e--,e||(clearInterval(o),A&&A())},1e3/C)},T.resetZoom=function(){p=70,t.projectionMatrix.makePerspective(p,Q.width/Q.height,1,1100),S()},T.updateImage=function(A){M(A),o||X(),o=A,y.innerHTML=""},T.addTarget=function(A,t){if(!o)return void console.warn("Can't add targets without an image source");A-=90;var n=document.createElement("img");n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAOw4AADsOAFxK8o4AAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAeZQTFRF////AQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACLzUaVQAAAKF0Uk5TAAECAwQICgwPEBESExQVFhgZGhscISMkJicpKistLzEyMzQ1Njc4OTo7PD0+QUJERkdITFRWWltdXl9hYmVnaGlqa2xtcHFyc3R1eHl6e4CEhYaHiY2SmZqbnp+goqWmp6mqq6ytrq+xsrO0tba3uLm9wMHCw8TFxsfJysvNztDR0tPU2N7f4OHi4+Tn6Onq6+zt7vDx8vP09/j5+vv8/f6z5o/8AAAI30lEQVR42u2da0MT1xaG30TMAaRWqmAUL0gFsQK2iDcqLRhQYqFHsKWmoYglwRa0RryhxabGgqCCRc5JxISE9U/PB+QUJJDb7Jm19+b5AbN8XpmdmX2ZBZiMvaS+0dXR3eP1BUZDE7PR6OxEaDTg8/Z0d7ga60vs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";var C=80,Q=Math.round(c/2-C/2),a=Math.round(c/2-C/2);Q+=Math.round(c/2*Math.cos(A*e)),a+=Math.round(c/2*Math.sin(A*e)),n.title=t.title||"",n.style.position="absolute",n.style.left=Q+"px",n.style.top=a+"px",n.style.width=C+"px",n.style.height=C+"px",n.style["-webkit-border-radius"]="100%",n.style["-moz-border-radius"]="100%",n.style["border-radius"]="100%",n.style["-moz-transform"]="rotateZ( "+(A+180)+"deg )",n.style["-webkit-transform"]="rotateZ( "+(A+180)+"deg )",n.style.transform="rotateZ( "+(A+180)+"deg )",n.style["box-shadow"]="0px 0px 30px #555",n.style.cursor="pointer",n.style.background="#aaa",n.onclick=function(e){e.preventDefault(),T.moveSoftTo({x:A+90,y:0},t.action)},y.appendChild(n)},z(),o&&(M(o),X())};